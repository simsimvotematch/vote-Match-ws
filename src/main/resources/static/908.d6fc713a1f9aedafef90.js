"use strict";(self.webpackChunkvote_match=self.webpackChunkvote_match||[]).push([[908],{4908:(R,m,o)=>{o.r(m),o.d(m,{SurveyModule:()=>x});var q=o(4466),c=o(1450),e=o(639),l=o(1841),f=o(6215),v=o(5917),y=o(3342);let g=(()=>{class s{constructor(t){this.http=t,this.questionsUrl="/api/questions",this.selectedQuestionSource=new f.X(JSON.parse(sessionStorage.getItem("currentQuestion"))||this.getFirstElement()),this.selectedQuestionChanges$=this.selectedQuestionSource.asObservable(),this.questionss=new f.X(null),this.questionsChanges$=this.questionss.asObservable()}changeSelectedProduct(t){this.selectedQuestionSource.next(t),sessionStorage.setItem("currentQuestion",JSON.stringify(t))}changeQuestions(t){this.questionss.next(t),sessionStorage.setItem("questions",JSON.stringify(t))}getQuestions(){return sessionStorage.getItem("questions")?(this.changeQuestions(JSON.parse(sessionStorage.getItem("questions"))),(0,v.of)(JSON.parse(sessionStorage.getItem("questions")))):this.questionss.value?(sessionStorage.setItem("questions",JSON.stringify(this.questionss.value)),(0,v.of)(this.questionss.value)):this.http.get(this.questionsUrl).pipe((0,y.b)(t=>this.changeQuestions(t)),(0,y.b)(t=>sessionStorage.setItem("questions",JSON.stringify(t))))}getQuestion(t){if(this.questionss.value){const n=this.questionss.value.find(u=>u.id===t);if(n)return(0,v.of)(n)}return this.http.get(`${this.questionsUrl}/${t}`)}saveQuestion(t){const r=new l.WM({"Content-Type":"application/json"});return this.updateData(t),this.updateQuestion(t,r)}updateQuestion(t,r){return this.http.put(`${this.questionsUrl}/${t.id}`,t,{headers:r})}getFirstElement(){return{id:1,question:"\u062e\u0644\u0642 \u0645\u0646\u0627\u0635\u0628 \u0634\u063a\u0644 \u0648\u062f\u0639\u0645 \u0627\u0644\u0635\u0646\u0627\u0639\u0629 \u0648\u0627\u0644\u0631\u0642\u0645\u0646\u0629",answer:null}}updateData(t){var r;null===(r=this.questionss.value)||void 0===r||r.forEach(function(n,u,a){n.id===t.id&&(a[u]=t)}),sessionStorage.setItem("questions",JSON.stringify(this.questionss.value))}reset(){sessionStorage.removeItem("user")}checkInfos(){return!!sessionStorage.getItem("user")}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(l.eN))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var d=o(665);let A=(()=>{class s{constructor(t,r){this.surveyService=t,this.router=r}ngOnDestroy(){console.log(this.questions),this.sub.unsubscribe()}ngOnInit(){this.surveyService.questionsChanges$.subscribe(t=>this.questions=t),this.sub=this.surveyService.getQuestions().subscribe(t=>{this.questions=t}),this.surveyService.selectedQuestionChanges$.subscribe(t=>this.selectedQuestion=t)}onAnswered(t){this.selectedQuestion.answer=t,this.surveyService.saveQuestion(this.selectedQuestion),this.questions.length>this.selectedQuestion.id?this.surveyService.getQuestion(this.selectedQuestion.id+1).subscribe(r=>this.surveyService.changeSelectedProduct(r)):this.router.navigate(["/survey/result"])}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(g),e.Y36(c.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-survey"]],decls:34,vars:4,consts:[[1,"page-header","mb-0"],[1,"container"],[1,"row"],[1,"col-12"],["href",""],[1,"booking"],[1,"row","align-items-center"],[1,"col-lg-7"],[1,"booking-content"],[1,"section-header"],[1,"text-to-right"],[1,"about-text"],[1,"text-to-right",2,"font-size","25px"],[1,"col-lg-5"],[1,"booking-form"],[1,"control-group"],[1,"input-group"],[1,"btn","custom-btn","mb-2",3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e.TgZ(4,"h2"),e._uU(5,"SimSim Vote-Match"),e.qZA(),e.qZA(),e.TgZ(6,"div",3),e.TgZ(7,"a",4),e._uU(8),e.qZA(),e.TgZ(9,"a",4),e._uU(10),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"div",5),e.TgZ(12,"div",1),e.TgZ(13,"div",6),e.TgZ(14,"div",7),e.TgZ(15,"div",8),e.TgZ(16,"div",9),e.TgZ(17,"h3",10),e._uU(18),e.qZA(),e.qZA(),e.TgZ(19,"div",11),e.TgZ(20,"p",12),e._uU(21),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(22,"div",13),e.TgZ(23,"div",14),e.TgZ(24,"form"),e.TgZ(25,"div",15),e._UZ(26,"div",16),e.TgZ(27,"div"),e.TgZ(28,"a",17),e.NdJ("click",function(){return r.onAnswered(!0)}),e._uU(29,"\u0646\u0639\u0645"),e.qZA(),e.TgZ(30,"a",17),e.NdJ("click",function(){return r.onAnswered(!1)}),e._uU(31,"\u0644\u0627"),e.qZA(),e.TgZ(32,"a",17),e.NdJ("click",function(){return r.onAnswered(null)}),e._uU(33,"\u062a\u062c\u0627\u0648\u0632 \u0627\u0644\u0633\u0624\u0627\u0644"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(8),e.hij("Question ",null==r.selectedQuestion?null:r.selectedQuestion.id,""),e.xp6(2),e.Oqu(null==r.questions?null:r.questions.length),e.xp6(8),e.hij("\u0627\u0644\u0633\u0624\u0627\u0644 ",r.selectedQuestion.id,""),e.xp6(3),e.hij(" ",r.selectedQuestion.question," "))},directives:[d._Y,d.JL,d.F],styles:[".text-to-right[_ngcontent-%COMP%]{text-align:right}"]}),s})();var S=o(8239);let p=(()=>{class s{constructor(t){this.http=t,this.user=JSON.parse(sessionStorage.getItem("user")),this.questions=JSON.parse(sessionStorage.getItem("questions")),this.party=JSON.parse(sessionStorage.getItem("party")),this.partiesUrl="/api/parties"}getParties(){return this.http.get(this.partiesUrl).pipe()}fillParty(t){const r=this.questions;return t.forEach(function(n,u,a){r.forEach(function(N,Z,w){n.inclinaisons[Z]===N.answer&&(a[u].userMatch+=n.inclinaisonsScore[Z])})}),t}findParty(t){var r=this;return(0,S.Z)(function*(){let n=r.fillParty(t),u=Math.max.apply(Math,n.map(function(a){return a.userMatch}));return n.filter(a=>a.userMatch===u)})()}getNumberOfAnsweredQuestion(){let t=0;return this.questions.forEach(function(r,n,u){null!=r.answer&&++t}),t}reset(){sessionStorage.removeItem("user"),sessionStorage.removeItem("questions"),sessionStorage.removeItem("currentQuestion")}checkInfos(){return!(!sessionStorage.getItem("user")||!sessionStorage.getItem("questions"))}addUser(t){var r=this;return(0,S.Z)(function*(){if(JSON.parse(sessionStorage.getItem("user"))){const n=new l.WM({"Content-Type":"application/json"});yield r.http.post("http://localhost:8024/userMatch",t,{headers:n}).toPromise(),sessionStorage.removeItem("user"),sessionStorage.removeItem("questions")}})()}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(l.eN))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var h=o(8583);function T(s,i){if(1&s&&(e.TgZ(0,"div",8),e.TgZ(1,"h2",9),e._uU(2),e.qZA(),e.TgZ(3,"div",10),e.TgZ(4,"p"),e._UZ(5,"i",11),e._uU(6),e.qZA(),e._uU(7," \xa0 "),e.TgZ(8,"p"),e._UZ(9,"i",12),e._uU(10),e.ALo(11,"date"),e.qZA(),e.qZA(),e.TgZ(12,"div",13),e._UZ(13,"img",14),e.TgZ(14,"p"),e._uU(15),e.qZA(),e.TgZ(16,"a",15),e._uU(17),e.ALo(18,"percent"),e.qZA(),e.qZA(),e.qZA()),2&s){const t=i.$implicit,r=e.oxw(2);e.xp6(2),e.Oqu(t.partyName),e.xp6(4),e.hij(" \xa0",t.partyName,""),e.xp6(4),e.hij(" \xa0",e.xi3(11,6,r.myDate,"shortDate"),""),e.xp6(3),e.Q6J("src",t.imageLink,e.LSH),e.xp6(2),e.hij(" ",t.partyDescription," "),e.xp6(2),e.hij("",e.lcZ(18,9,(t.userMatch/r.answeredQuestion+3)/10)," OF MATCH")}}function b(s,i){if(1&s&&(e.TgZ(0,"div",6),e.YNc(1,T,19,11,"div",7),e._UZ(2,"br"),e._UZ(3,"br"),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.parties)}}let I=(()=>{class s{constructor(t){this.surveyResult=t,this.myDate=new Date,this.users=[]}ngOnDestroy(){this.sub.unsubscribe(),this.surveyResult.reset()}ngOnInit(){this.sub=this.surveyResult.getParties().subscribe(t=>{this.surveyResult.findParty(t).then(r=>{this.parties=r;for(let n=0;n<this.parties.length;n++){const u=this.parties[n];console.log("element",u),this.user=JSON.parse(sessionStorage.getItem("user")),this.user.id_hizb=u.id,sessionStorage.setItem("user",JSON.stringify(this.user)),this.surveyResult.addUser(this.user)}})}),this.answeredQuestion=this.surveyResult.getNumberOfAnsweredQuestion()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(p))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-survey-result"]],decls:14,vars:1,consts:[[1,"blog"],[1,"container"],[1,"section-header","text-center"],[1,"row","align-items-center"],[1,"col-lg-12",2,"margin-top","97px","margin-right","80px"],["class","blog-item",4,"ngIf"],[1,"blog-item"],["class","blog-content","style","margin-bottom: 15px",4,"ngFor","ngForOf"],[1,"blog-content",2,"margin-bottom","15px"],[1,"blog-title"],[1,"blog-meta"],[1,"far","fa-list-alt"],[1,"far","fa-calendar-alt"],[1,"blog-text"],[1,"imagecadre",3,"src"],[1,"btn","custom-btn"]],template:function(t,r){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"p"),e._UZ(4,"br"),e._UZ(5,"br"),e._UZ(6,"br"),e._UZ(7,"br"),e.qZA(),e.TgZ(8,"h2"),e._uU(9,"Your Match - Vote"),e.qZA(),e.TgZ(10,"div",1),e.TgZ(11,"div",3),e.TgZ(12,"div",4),e.YNc(13,b,4,1,"div",5),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(13),e.Q6J("ngIf",r.parties))},directives:[h.O5,h.sg],pipes:[h.uU,h.Zx],styles:[".imagecadre[_ngcontent-%COMP%]{max-width:400px!important;height:auto}"]}),s})(),Q=(()=>{class s{constructor(t,r){this.router=t,this.surveyResult=r}canDeactivate(t,r,n,u){return this.resetElement()}resetElement(){return this.surveyResult.reset(),this.router.navigate(["/"]),!0}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(c.F0),e.LFG(p))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),G=(()=>{class s{constructor(t,r){this.router=t,this.surveyResult=r}canActivate(t,r){return this.checkinfos()}checkinfos(){return!!this.surveyResult.checkInfos()||(this.router.navigate(["/survey"]),!1)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(c.F0),e.LFG(p))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),O=(()=>{class s{constructor(t,r){this.router=t,this.surveyService=r,this.currentQuestion=JSON.parse(sessionStorage.getItem("currentQuestion"))}canDeactivate(t,r,n,u){return!(!u||"/survey/result"!==u.url||26!==this.currentQuestion.id)||(confirm("do you wanna realy leave this survey")&&(console.log(),this.resetElement()),!1)}resetElement(){return this.surveyService.reset(),this.router.navigate(["/welcome"]),!0}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(c.F0),e.LFG(g))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),U=(()=>{class s{constructor(t,r){this.router=t,this.surveyService=r}canActivate(t,r){return this.checkinfos()}checkinfos(){return!!this.surveyService.checkInfos()||(this.router.navigate(["/welcome"]),!1)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(c.F0),e.LFG(g))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var F=o(2886);let x=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[q.m,c.Bz.forChild([{path:"",canDeactivate:[O],canActivate:[U],component:A},{path:"result",canDeactivate:[Q],canActivate:[G],component:I}]),F.K1]]}),s})()}}]);